
https://github.com/supabase/supabase

- [Self-Hosting with Docker](https://supabase.com/docs/guides/self-hosting/docker)

```sh
git clone --depth 1 https://github.com/supabase/supabase

# output
Cloning into 'supabase'...
remote: Enumerating objects: 13589, done.
remote: Counting objects: 100% (13589/13589), done.
remote: Compressing objects: 100% (11766/11766), done.
error: RPC failed; curl 55 LibreSSL SSL_read: LibreSSL/3.3.6: error:1404C42E:SSL routines:ST_OK:tlsv1 alert protocol version, errno 0
error: 4901 bytes of body are still expected
fetch-pack: unexpected disconnect while reading sideband packet
fatal: early EOF
fatal: index-pack failed

# solution
brew update
brew upgrade git openssl

which git  # æŸ¥çœ‹å½“å‰ git è·¯å¾„
brew install git  # å¦‚æœæœªé€šè¿‡ brew å®‰è£…ï¼Œå…ˆå®‰è£…

git clone --depth 1 https://github.com/supabase/supabase

Cloning into 'supabase'...
fatal: unable to access 'https://github.com/supabase/supabase/': LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443 

# å¯èƒ½è¦å¼€åŠ é€Ÿ
brew install git
source ~/.zshrc


# prepare: docker installed

# Get the code
git clone --depth 1 https://github.com/supabase/supabase

# Make your new supabase project directory
mkdir supabase-project

# Tree should look like this
# .
# â”œâ”€â”€ supabase
# â””â”€â”€ supabase-project

# Copy the compose files over to your project
cp -rf supabase/docker/* supabase-project

# Copy the fake env vars
cp supabase/docker/.env.example supabase-project/.env

# Switch to your project directory
cd supabase-project

# Pull the latest images
# è¿™æ­¥é‡åˆ°è®¿é—®é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆï¼šåœ¨dockerä¸­é…ç½®`registry-mirrors`ï¼›å›¾å½¢ç•Œé¢ä¸­å¯åœ¨è®¾ç½®çš„Docker Engineé‚£ä¸ªjsoné‡Œæ·»åŠ ï¼›è®¾ç½®å®Œé‡å¯å®Œå†æ¬¡è¿è¡Œ`docker compose pull`å‘½ä»¤
# "registry-mirrors": [
#     "https://docker-0.unsee.tech",
#     "https://docker-cf.registry.cyou",
#     "https://docker.1panel.live"
# ]
# å‚è€ƒï¼š[äº‘æœåŠ¡å™¨dockeré•œåƒæ‹‰å–å¤±è´¥æ€ä¹ˆè§£å†³](https://cloud.tencent.com/developer/article/2529418)
#è¦è·‘ä¸€ä¼šå„¿
docker compose pull

# Start the services (in detached mode)
docker compose up -d
```

### è®¾ç½®é€šçŸ¥é‚®ç®±ï¼ˆç”¨äºç”¨é‚®ç®±ç™»å½•çš„æ—¶å€™ï¼Œå‘é€ç™»å½•éªŒè¯é“¾æ¥ï¼Œä¹Ÿå¯ä»¥åœ¨`.env`è®¾ç½®è‡ªåŠ¨é€šè¿‡ï¼‰

è¿›å…¥é¡¹ç›®ç›®å½•`cd supabase-project`ï¼Œå¦‚æœæ­£åœ¨è¿è¡Œï¼Œåˆ™`docker compose down`å…³é—­æœåŠ¡ï¼Œæ‰“å¼€`.env`è®¾ç½®ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯qqé‚®ç®±ï¼š
```sh
## Email auth
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=false
SMTP_ADMIN_EMAIL=example@qq.com
SMTP_HOST=smtp.qq.com
SMTP_PORT=465
SMTP_USER=example@qq.com
SMTP_PASS=xxx
SMTP_SENDER_NAME=supabase-notify
ENABLE_ANONYMOUS_USERS=false
```

è®¾ç½®å®Œæˆåï¼Œ`docker compose up -d`å¯åŠ¨æœåŠ¡ã€‚

### å‰ç«¯web demo

- [Vueå¿«é€Ÿä¸Šæ‰‹](https://cn.vuejs.org/guide/quick-start.html)

```sh
nvm use v20.19.3
yarn create vue
cd supabase-web
yarn
yarn dev
```

### æš´éœ²æ•°æ®åº“ç«¯å£

`docker-compose.yml`

```yml
db:
    container_name: supabase-db
    image: supabase/postgres:15.8.1.060
    restart: unless-stopped
    # ....
    # ğŸ‘‡ æ·»åŠ è¿™ä¸€è¡Œæ¥æš´éœ² PostgreSQL ç«¯å£
    ports:
      - "54321:5432"  # å®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£
```

### ERROR:  column "datlastsysoid" does not exist LINE 1: SELECT DISTINCT datlastsysoid FROM pg_database

`libcc-premium.dylib`
search 'SELECT DISTINCT datlastsysoid'
replace to 'SELECT DISTINCT dattablespace'
use codesign re-sign the new file

Postgres 15 removed datlastsysoid field from pg_database table, so any version prior to Navicat 15.0.29 or 16.1 will raise this error while looking for this deprecated field.

To fix this, either upgrade to the latest Navicat 15.0.29 or 16.1 and up (might require new license), or do this:

Exit Navcat.

Open Navicat folder (usually under C:\Program Files\PremiumSoft\Navicat....), depends on your Navicat edition

Locate libcc.dll and create a backup of this file (copy and paste it as "libcc-backup.dll" or any other name)

Open this file in any HEX editor, you can use online tool such as https://hexed.it/ if you want.

Search for "SELECT DISTINCT datlastsysoid" in the file, and replace it with "SELECT DISTINCT dattablespace"

Save the file in the original location. If you get any security issues, save it as ".txt" file, and then rename it to ".dll"

That's it! Navicat now works as before. If you have ESET or other security tools, the dll file might be locked for few minutes, for security checkup. Be patient, and try after ~5 min again...

Enjoy!

- [Cannot open connection after connecting to Postgres 15 using Navicat Premium](https://stackoverflow.com/questions/74773611/cannot-open-connection-after-connecting-to-postgres-15-using-navicat-premium)